.MMM-Webuntis {
  /* Theme: neutral base */
  --wu-bg: rgba(var(--wu-rgb-black), var(--wu-alpha-subtle));
  --wu-lesson-surface: #ffffff;
  --wu-text-on-dark: #ffffff;
  --wu-time-color: #666;
  --wu-border-strong: #333;
  --wu-border-muted: #444;
  --wu-lesson-outline: #ccc;
  --wu-split-divider: rgba(var(--wu-rgb-black), var(--wu-alpha-subtle));
  --wu-rgb-black: 0, 0, 0;
  --wu-rgb-white: 255, 255, 255;
  --wu-rgb-light-line: 239, 239, 239;
  --wu-rgb-accent-red: 214, 69, 69;
  --wu-alpha-subtle: 0.06;
  --wu-alpha-soft: 0.1;
  --wu-alpha-medium: 0.45;
  --wu-alpha-strong: 0.85;

  /* Theme: core accents (design language) */
  --wu-accent-blue: #2f80ed;
  --wu-accent-blue-bg: #dbe9ff;
  --wu-accent-blue-bg-strong: #c6dcff;
  --wu-accent-blue-text: #0f2f57;
  --wu-accent-yellow: #e0b000;
  --wu-accent-yellow-bg: #fff1bf;
  --wu-accent-yellow-text: #5a4700;
  --wu-accent-red: #d64545;
  --wu-accent-red-bg: #f9d8d8;
  --wu-accent-red-bg-strong: #f3bcbc;
  --wu-accent-red-text: #5a1212;

  /* Feedback: states (blue/yellow/red) */
  --wu-replacement-bg: var(--wu-accent-blue-bg);
  --wu-replacement-text: var(--wu-accent-blue-text);
  --wu-cancelled-bg: var(--wu-accent-red-bg);
  --wu-cancelled-text: var(--wu-accent-red-text);
  --wu-regular-bg: #e8f1ff;
  --wu-regular-text: #123a66;
  --wu-lesson-border: #8fb5e6;
  --wu-no-lesson-bg: var(--wu-accent-yellow-bg);
  --wu-no-lesson-text: var(--wu-accent-yellow-text);
  --wu-exam-bar: var(--wu-accent-yellow);
  --wu-break-supervision-bg: var(--wu-accent-blue-bg-strong);
  --wu-break-supervision-text: var(--wu-accent-blue-text);
  --wu-substitution-generic: var(--wu-accent-yellow-text);
  --wu-substitution-accent: #c69200;
  --wu-exam-description-color: var(--wu-accent-yellow-text);
  --wu-holiday-notice-color: var(--wu-accent-yellow-text);
  --wu-absence-excused-color: var(--wu-accent-blue);
  --wu-absence-unexcused-color: var(--wu-accent-red);
  --wu-warning-color: var(--wu-accent-yellow);
  --wu-warning-bg-soft: rgba(255, 241, 191, var(--wu-alpha-soft));
  --wu-warning-bg-strong: rgba(255, 241, 191, var(--wu-alpha-medium));
  --wu-critical-color: var(--wu-accent-red);
  --wu-critical-bg: rgba(var(--wu-rgb-accent-red), var(--wu-alpha-soft));
  --wu-error-text: var(--wu-accent-red-text);
  --wu-error-bg: var(--wu-accent-red-bg);
  --wu-error-border: var(--wu-accent-red);
  --wu-legacy-exam-row-color: var(--wu-accent-yellow);

  /* Feedback: today variants (same color system, stronger intensity) */
  --wu-today-replacement-bg: var(--wu-accent-blue-bg-strong);
  --wu-today-replacement-text: #0b2a4f;
  --wu-today-cancelled-bg: var(--wu-accent-red-bg-strong);
  --wu-today-cancelled-text: #4c0e0e;
  --wu-today-regular-bg: #d5e6ff;
  --wu-today-regular-text: #0f335c;
  --wu-today-lesson-border: #7da6da;

  /* Overlay & Timeline */
  --wu-grid-more-bg: rgba(var(--wu-rgb-black), var(--wu-alpha-medium));
  --wu-absence-overlay-bg: rgba(var(--wu-rgb-accent-red), var(--wu-alpha-medium));
  --wu-absence-overlay-border: var(--wu-accent-red);
  --wu-absence-overlay-today-bg: rgba(var(--wu-rgb-accent-red), var(--wu-alpha-medium));
  --wu-absence-overlay-today-border: var(--wu-accent-red);
  --wu-absence-icon-shadow: rgba(var(--wu-rgb-black), var(--wu-alpha-medium));
  --wu-absence-reason-color: var(--wu-accent-red-text);
  --wu-absence-reason-shadow: rgba(var(--wu-rgb-white), var(--wu-alpha-strong));
  --wu-hourline-color: rgba(var(--wu-rgb-light-line), var(--wu-alpha-medium));
  --wu-nowline-start: rgba(var(--wu-rgb-accent-red), var(--wu-alpha-strong));
  --wu-nowline-end: rgba(var(--wu-rgb-accent-red), var(--wu-alpha-medium));
  --wu-nowline-glow: rgba(var(--wu-rgb-accent-red), var(--wu-alpha-soft));

  /* Text & Highlights */
  --wu-secondary-text: #888;
  --wu-muted-text: #999;
  --wu-message-text: #ddd;
  --wu-changed-highlight: var(--wu-substitution-accent);
  --wu-message-card-bg: rgba(var(--wu-rgb-white), var(--wu-alpha-soft));
  --wu-message-card-border: var(--wu-accent-yellow);

  /* Patterns */
  --wu-stripe-light: rgba(var(--wu-rgb-white), var(--wu-alpha-soft));
  --wu-stripe-dark: rgba(var(--wu-rgb-black), 0.12);

  /* Layout & Spacing */
  --wu-lesson-radius: 4px;
  --wu-lesson-padding: 2px;
  --wu-ticker-padding-block: 1px;
  --wu-ticker-padding-inline: 2px;
  --wu-ticker-stack-gap: 2px;
  --wu-ticker-item-gap: 1px;
  --wu-homework-icon-top: 2px;
  --wu-homework-icon-right: 0px;
  --wu-homework-padding: 2px;
  --wu-exam-border-width: 6px;
  --wu-messages-min-width: 200px;
  --wu-messages-max-cols: 3;

  /* Icons */
  --wu-icon-warning: 'âš ï¸';
  --wu-icon-homework: 'ðŸ“˜';
  --wu-icon-break-supervision: 'ðŸ””';
  --wu-icon-holiday: 'ðŸ–ï¸';
  --wu-icon-no-lessons: 'ðŸ“…';
  --wu-icon-absence: 'âš¡';
  --wu-icon-moved: 'â†•';
  width: 100%;
  box-sizing: border-box;
  font-size: 0.875rem;
}

.MMM-Webuntis *,
.MMM-Webuntis *::before,
.MMM-Webuntis *::after {
  box-sizing: inherit;
}

/* Widget Container (replaces table) */
.MMM-Webuntis .wu-widget-container {
  display: grid;
  grid-template-columns: auto auto 1fr;
  column-gap: 0.5rem;
  row-gap: 0.25rem;
  width: 100%;
  margin-bottom: 0.6rem;
  text-align: left;
}

.MMM-Webuntis > .wu-widget-container:last-child {
  margin-bottom: 0;
}

/* Widget Error Boundary */
.MMM-Webuntis .widget-error {
  display: block;
  grid-column: 1 / -1;
  padding: 0.5rem 0.75rem;
  margin: 0.5rem 0 0.5rem 0;
  background-color: var(--wu-error-bg);
  border-left: 4px solid var(--wu-error-border);
  border-radius: 2px;
  color: var(--wu-error-text);
  font-weight: 500;
  text-align: left;
}

.MMM-Webuntis .widget-error.dimmed {
  opacity: 0.7;
}

/* Widget Row (replaces tr) - now transparent container */
.MMM-Webuntis .wu-row {
  display: contents;
  /* Makes row transparent, cols become direct grid items */
}

/* Widget Row Header (for verbose mode) - overrides display: contents */
.MMM-Webuntis .wu-row-header {
  display: block;
  /* Override contents for header */
  grid-column: 1 / -1;
  /* Spans all columns */
  font-weight: bold;
  padding-bottom: 0.25rem;
  border-bottom: 1px solid var(--wu-border-strong);
  text-align: left;
}

/* Widget Columns (replaces td) */
.MMM-Webuntis .wu-col {
  white-space: pre-line;
  text-align: left;
}

.MMM-Webuntis .wu-col-student {
  font-weight: bold;
  white-space: nowrap;
  text-align: left;
}

.MMM-Webuntis .wu-col-meta {
  white-space: nowrap;
  text-align: left;
}

.MMM-Webuntis .wu-col-data {
  word-break: break-word;
  white-space: pre-line;
  text-align: left;
}

.MMM-Webuntis .wu-col-full {
  /* When only one data column is present, it should span both meta and data */
  grid-column: 2 / -1;
  text-align: left;
}

.MMM-Webuntis .wu-col-full-width {
  /* Full row without student/meta columns - spans all 3 grid columns */
  grid-column: 1 / -1;
  text-align: left;
}

.MMM-Webuntis .cancelled {
  text-decoration: line-through;
}

.MMM-Webuntis .substitution {
  color: var(--wu-substitution-generic);
  font-weight: bold;
}

.MMM-Webuntis .error {
  color: var(--wu-error-text);
}

.MMM-Webuntis .info {
  font-style: italic;
}

.MMM-Webuntis .student {
  padding-top: 0.94rem;
  border-bottom: 1px solid var(--wu-border-strong);
}

/* Widget rows */
.MMM-Webuntis .examRow,
.MMM-Webuntis .examRowEmpty {
  color: var(--wu-legacy-exam-row-color);
}

.MMM-Webuntis .grid-timecell {
  padding: 0.1rem 0.4rem 0.1rem 0;
  border-bottom: 1px dotted var(--wu-border-muted);
  white-space: pre-line;
  vertical-align: top;
}

.MMM-Webuntis .grid-days-header {
  margin-bottom: 0.25rem;
  align-items: center;
  display: grid;
}

/* Combined grid (time + content) */
.MMM-Webuntis .grid-combined {
  display: grid;
  grid-template-columns: minmax(5.625rem, auto) 1fr;
  gap: 0.125rem;
  background: var(--wu-bg);
  border-radius: var(--wu-lesson-radius);
  overflow: hidden;
  position: relative;
}

.MMM-Webuntis .grid-combined .grid-timecell {
  border-bottom: 1px dotted var(--wu-border-muted);
  display: flex;
  align-items: center;
  justify-content: flex-end;
  font-size: 0.9rem;
  color: var(--wu-time-color);
  padding: 0.1rem 0.4rem 0.1rem 0;
}

.MMM-Webuntis .grid-combined .grid-timecell > div {
  margin: 0;
  padding: 0;
  line-height: 1;
  font-size: 0.78rem;
}

.MMM-Webuntis .grid-combined .day-column-inner {
  position: relative;
  width: 100%;
  height: 100%;
}

.MMM-Webuntis .grid-combined .grid-lesson {
  position: absolute;
  left: 0;
  right: 0;
  border-radius: var(--wu-lesson-radius);
  padding: var(--wu-lesson-padding);
  box-sizing: border-box;
  overflow: hidden;
  display: flex;
  flex-direction: row;
  align-items: stretch;
  z-index: 1;
  border: 1px solid var(--wu-lesson-outline);
  background: var(--wu-lesson-surface);
  text-align: left;
  line-height: 1;
}

.MMM-Webuntis .grid-combined .grid-lesson.has-exam {
  border-left: var(--wu-exam-border-width) solid var(--wu-exam-bar);
  padding-left: var(--wu-homework-padding);
}

.MMM-Webuntis .day-column-inner.is-today {
  --wu-replacement-bg: var(--wu-today-replacement-bg);
  --wu-replacement-text: var(--wu-today-replacement-text);
  --wu-cancelled-bg: var(--wu-today-cancelled-bg);
  --wu-cancelled-text: var(--wu-today-cancelled-text);
  --wu-regular-bg: var(--wu-today-regular-bg);
  --wu-regular-text: var(--wu-today-regular-text);
  --wu-lesson-border: var(--wu-today-lesson-border);
}

.MMM-Webuntis .grid-combined .no-lesson {
  background-color: var(--wu-no-lesson-bg);
  padding: 0.313rem;
  color: var(--wu-no-lesson-text);
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  text-align: center;
}

.MMM-Webuntis .grid-combined .grid-more-badge {
  position: absolute;
  right: 6px;
  bottom: 6px;
  z-index: 30;
  padding: 2px 6px;
  background: var(--wu-grid-more-bg);
  color: var(--wu-text-on-dark);
  border-radius: 4px;
  font-size: 0.85em;
  cursor: default;
}

.MMM-Webuntis .lesson-content {
  position: relative;
  border-radius: var(--wu-lesson-radius);
  padding: 1px var(--wu-lesson-padding);
  padding-right: var(--wu-lesson-padding);
  box-sizing: border-box;
  overflow: hidden;
  line-height: 1.1;
}

.MMM-Webuntis .grid-combined .grid-lesson > .lesson-content {
  flex: 1 1 auto;
  width: 100%;
  min-width: 0;
}

.MMM-Webuntis .lesson-content.has-icons {
  padding-right: calc(var(--wu-homework-padding) + 30px);
}

.MMM-Webuntis .grid-combined .lesson-content {
  font-size: 0.7rem;
}

/* Common styling for lessons in grid and ticker */
.MMM-Webuntis .grid-combined .lesson-substitution,
.MMM-Webuntis .ticker-item .lesson-content.lesson-substitution {
  background-color: var(--wu-replacement-bg);
  color: var(--wu-replacement-text);
}

/* Split view: generic layout â€” any status can appear in either half */
.MMM-Webuntis .grid-combined .split-left {
  left: 0;
  right: auto;
  width: 50%;
  border-right: 1px solid var(--wu-split-divider);
  overflow: hidden;
}
.MMM-Webuntis .grid-combined .split-right {
  left: auto;
  right: 0;
  width: 50%;
}

/* Cancelled lesson in split-right always gets cancelled styling */
.MMM-Webuntis .grid-combined .lesson-cancelled.split-right {
  background-color: var(--wu-cancelled-bg);
  color: var(--wu-cancelled-text);
}

.MMM-Webuntis .grid-combined .lesson-cancelled,
.MMM-Webuntis .ticker-item .lesson-content.lesson-cancelled {
  background-color: var(--wu-cancelled-bg);
  color: var(--wu-cancelled-text);
}

.MMM-Webuntis .grid-combined .lesson-regular,
.MMM-Webuntis .ticker-item .lesson-content.lesson-regular {
  background-color: var(--wu-regular-bg);
  color: var(--wu-regular-text);
}

.MMM-Webuntis .grid-combined .lesson-break-supervision,
.MMM-Webuntis .grid-combined .lesson-content.break-supervision,
.MMM-Webuntis .ticker-item .lesson-content.break-supervision {
  background-color: var(--wu-break-supervision-bg);
  color: var(--wu-break-supervision-text);
  font-weight: 500;
}

/* Ensure inner content fills the parent cell for consistent visuals */
.MMM-Webuntis .grid-combined .grid-lesson.lesson-break-supervision > .lesson-content {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 2px;
  overflow: hidden;
  font-size: 0.8em;
  line-height: 1.1;
}

/* Override lesson-primary and lesson-secondary styles within break-supervision */
.MMM-Webuntis .grid-combined .lesson-content.break-supervision .lesson-primary,
.MMM-Webuntis .grid-combined .lesson-content.break-supervision .lesson-secondary {
  position: static !important; /* override any absolute positioning */
  margin: 0;
  padding: 0;
  color: var(--wu-break-supervision-text) !important;
  font-size: 9px;
  line-height: 1;
}

.MMM-Webuntis .grid-combined .lesson-regular {
  border-color: var(--wu-lesson-border);
  padding: var(--wu-lesson-padding);
}

/* Overlay for past lessons; opacity is toggled to fade in stripes */
.MMM-Webuntis .grid-combined .grid-lesson::after {
  content: '';
  position: absolute;
  inset: 0;
  background-image: repeating-linear-gradient(135deg, var(--wu-stripe-light) 0 8px, var(--wu-stripe-dark) 8px 18px);
  opacity: 0;
  pointer-events: none;
  border-radius: var(--wu-lesson-radius);
  transition: opacity 360ms ease-in-out;
}

.MMM-Webuntis .grid-combined .grid-lesson.past::after {
  opacity: 0.72;
}

.MMM-Webuntis .grid-combined .lesson {
  border: 1px solid var(--wu-lesson-outline);
  border-radius: var(--wu-lesson-radius);
  text-align: left;
}

.MMM-Webuntis .grid-combined .homework-icon,
.MMM-Webuntis .lesson-content .homework-icon {
  position: static;
  font-size: 0.9rem;
  line-height: 1;
  z-index: auto;
  display: inline-flex;
  width: 14px;
  height: 14px;
  align-items: center;
  justify-content: center;
  border-radius: 2px;
  background: var(--wu-accent-blue);
  color: var(--wu-text-on-dark);
  overflow: hidden;
}

.MMM-Webuntis .homework-icon::before {
  content: var(--wu-icon-homework);
}

/* Absence Overlay - Vertical bar on right side, ~1/3 width */
.MMM-Webuntis .grid-combined .grid-absence-overlay {
  position: absolute;
  right: 0;
  width: 66%;
  min-width: 40px;
  border-radius: var(--wu-lesson-radius) 0 0 var(--wu-lesson-radius);
  background: var(--wu-absence-overlay-bg);
  border-left: 2px solid var(--wu-absence-overlay-border);
  pointer-events: auto;
  z-index: 2;
  cursor: default;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  overflow: visible;
}

.MMM-Webuntis .grid-combined .day-column-inner.is-today .grid-absence-overlay {
  background: var(--wu-absence-overlay-today-bg);
  border-left-color: var(--wu-absence-overlay-today-border);
}

/* Absence overlay icon and text */
.MMM-Webuntis .grid-combined .grid-absence-overlay .absence-icon {
  font-size: 1.2em;
  line-height: 1;
  margin-bottom: 4px;
  filter: drop-shadow(0 0 2px var(--wu-absence-icon-shadow));
}

.MMM-Webuntis .grid-combined .grid-absence-overlay .absence-icon::before {
  content: var(--wu-icon-absence);
}

.MMM-Webuntis .grid-combined .grid-absence-overlay .absence-reason {
  font-size: 0.7em;
  font-weight: 600;
  color: var(--wu-absence-reason-color);
  text-shadow: 0 0 2px var(--wu-absence-reason-shadow);
  text-align: center;
  word-break: break-word;
  padding: 2px 4px;
  line-height: 1.2;
}

.MMM-Webuntis .holiday-notice {
  background: transparent;
  color: var(--wu-holiday-notice-color);
  font-weight: 600;
  padding-left: 0.25rem;
}

.MMM-Webuntis .grid-hourline {
  height: 1px;
  background: var(--wu-hourline-color);
  position: absolute;
  left: 0;
  right: 0;
  z-index: 0;
}

.MMM-Webuntis .grid-nowline {
  position: absolute;
  left: 0;
  right: 0;
  height: 2px;
  background: linear-gradient(90deg, var(--wu-nowline-start), var(--wu-nowline-end));
  box-shadow: 0 0 6px var(--wu-nowline-glow);
  z-index: 3;
  pointer-events: none;
}

.MMM-Webuntis .absence-excused {
  color: var(--wu-absence-excused-color);
}

/* Presentation: uppercase day labels and meta/date columns */
.MMM-Webuntis .grid-daylabel,
.MMM-Webuntis .wu-col-meta {
  /* text-transform: uppercase; */
  text-align: left;
}

.MMM-Webuntis .absence-unexcused {
  color: var(--wu-absence-unexcused-color);
  font-weight: 600;
}

.MMM-Webuntis .absences-unavailable-info {
  display: block;
  padding: 0.5rem;
  margin-bottom: 0.6rem;
  border-left: 3px solid var(--wu-warning-color);
  background-color: var(--wu-warning-bg-strong);
  font-style: italic;
}

.MMM-Webuntis .mmm-webuntis-warning {
  display: block;
  padding: 0.4rem 0.6rem;
  margin-bottom: 0.6rem;
  border-left: 3px solid var(--wu-warning-color);
  background-color: var(--wu-warning-bg-soft);
  color: var(--wu-warning-color);
  font-weight: 600;
}

/* Critical warnings (e.g., dependency issues) */
.MMM-Webuntis .mmm-webuntis-warning.critical {
  border-left-color: var(--wu-critical-color);
  background-color: var(--wu-critical-bg);
  color: var(--wu-critical-color);
  font-weight: 700;
  animation: pulse-warning 2s ease-in-out infinite;
}

@keyframes pulse-warning {
  0%,
  100% {
    opacity: 1;
  }

  50% {
    opacity: 0.7;
  }
}

/* Ticker Animation for Multiple Lessons in Same Time Slot */
.MMM-Webuntis .lesson-ticker-wrapper {
  overflow: hidden;
  background: transparent;
  /* No border, no padding - items have their own styling */
}

.MMM-Webuntis .ticker-track {
  display: flex;
  flex-direction: row;
  flex-wrap: nowrap;
  height: 100%;
  align-items: stretch;
  gap: var(--wu-ticker-item-gap);
  /* Horizontal spacing between ticker items */
}

.MMM-Webuntis .ticker-item {
  flex-shrink: 0;
  padding: 0;
  margin: 0;
  box-sizing: border-box;
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  /* Align content to left, not center */
  justify-content: flex-start;
  /* Align content to top, not center */
  text-align: left;
  /* Left-align text like normal lessons */
  line-height: 1;
  overflow: hidden;
}

/* Ticker items with stacked lesson-content */
.MMM-Webuntis .ticker-item:has(.lesson-content) {
  border: none;
  padding: 0;
  background: transparent;
  border-radius: 0;
  gap: var(--wu-ticker-stack-gap);
  /* Gap between stacked lessons */
}

/* Lesson content within ticker items (for stacked lessons) */
.MMM-Webuntis .ticker-item .lesson-content {
  border-radius: var(--wu-lesson-radius);
  width: 100%;
  padding: var(--wu-ticker-padding-block) var(--wu-ticker-padding-inline);
  box-sizing: border-box;
  overflow: hidden;
  position: relative;
  /* For absolute positioning of homework icon */
}

@keyframes ticker-scroll {
  0% {
    transform: translateX(0);
  }

  100% {
    transform: translateX(-50%);
  }
}

/* Apply styling to ticker items based on lesson type */
.MMM-Webuntis .lesson-ticker-wrapper .ticker-item .lesson-content.past::after {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-image: repeating-linear-gradient(135deg, var(--wu-stripe-light) 0 8px, var(--wu-stripe-dark) 8px 18px);
  opacity: 0.72;
  pointer-events: none;
  border-radius: var(--wu-lesson-radius);
}

.MMM-Webuntis .lesson-ticker-wrapper .ticker-item.has-exam::before {
  content: '';
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  width: 4px;
  background: var(--wu-exam-bar);
}

/* Semantic CSS Classes for Accessibility */

/* Lesson Primary Field (Grid & Lessons) */
.MMM-Webuntis .lesson-primary {
  font-weight: 600;
  font-size: 0.75rem;
  display: block;
  white-space: normal;
  overflow: visible;
  text-overflow: clip;
}

/* Lesson Secondary Field (Grid & Lessons) */
.MMM-Webuntis .lesson-secondary {
  font-size: 0.69rem;
  color: var(--wu-secondary-text);
  font-weight: 400;
  display: block;
  white-space: normal;
  overflow: visible;
  text-overflow: clip;
  line-height: 1.15;
  max-width: 100%;
}

/* Teacher Name (inline in Lessons/Exams widgets) */
.MMM-Webuntis .teacher-name {
  color: var(--wu-secondary-text);
  font-weight: 400;
  font-size: inherit;
}

/* Substitution Text (yellow/orange) */
.MMM-Webuntis .lesson-substitution-text {
  font-size: 0.75rem;
  color: var(--wu-substitution-accent);
  font-style: italic;
  font-weight: 500;
  display: block;
}

/* General Lesson Info Text (lstext field) */
.MMM-Webuntis .lesson-info-text {
  font-size: 0.75rem;
  color: var(--wu-muted-text);
  font-style: italic;
  display: block;
}

.MMM-Webuntis .lesson-changed-new {
  color: var(--wu-changed-highlight);
  font-weight: 700;
}

/* MOVED lesson badge (lesson shifted to different time) */
.MMM-Webuntis .lesson-moved-badge {
  font-size: 0.85rem;
  position: static;
  opacity: 1;
  margin: 0;
  line-height: 1;
  z-index: auto;
  display: inline-flex;
  width: 14px;
  height: 14px;
  align-items: center;
  justify-content: center;
  color: #1e1e1e;
}

.MMM-Webuntis .lesson-moved-badge::before {
  content: var(--wu-icon-moved);
}

.MMM-Webuntis .lesson-inline-icon {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  margin-right: 0.2rem;
}

.MMM-Webuntis .lesson-inline-icon-holiday::before,
.MMM-Webuntis .day-notice-icon-holiday::before {
  content: var(--wu-icon-holiday);
}

.MMM-Webuntis .lesson-break-supervision-icon::before {
  content: var(--wu-icon-break-supervision);
}

.MMM-Webuntis .day-notice-icon {
  display: block;
  line-height: 1;
  margin-bottom: 4px;
}

.MMM-Webuntis .day-notice-icon-no-lessons::before {
  content: var(--wu-icon-no-lessons);
}

.MMM-Webuntis .wu-inline-icon {
  display: inline-flex;
  align-items: center;
  justify-content: center;
}

.MMM-Webuntis .wu-icon-warning::before {
  content: var(--wu-icon-warning);
}

.MMM-Webuntis .lesson-icons {
  position: absolute;
  right: var(--wu-homework-icon-right);
  top: var(--wu-homework-icon-top);
  display: inline-flex;
  align-items: center;
  gap: 2px;
  z-index: 3;
  min-width: 14px;
}

/* Exam Description */
.MMM-Webuntis .exam-description {
  font-size: 0.8rem;
  color: var(--wu-exam-description-color);
  font-weight: 600;
}

/* Message Subject */
.MMM-Webuntis .message-subject {
  font-weight: 700;
  font-size: 1rem;
  display: block;
  margin-bottom: 4px;
}

/* Message Text */
.MMM-Webuntis .message-text {
  font-size: 0.9rem;
  color: var(--wu-message-text);
  display: block;
}

/* Messages Grid Layout */
.MMM-Webuntis .messages-grid {
  display: block;
  columns: var(--wu-messages-max-cols) var(--wu-messages-min-width);
  column-gap: 5px;
  column-fill: balance;
  margin-bottom: 5px;
  grid-column: 1 / -1; /* Ensure it spans full width of widget container */
  width: 100%;
}

.MMM-Webuntis.messagesofday {
  max-width: 100%;
}

.MMM-Webuntis .messages-grid .messageRow {
  display: flex; /* Override display: contents from .wu-row */
  background-color: var(--wu-message-card-bg);
  border-left: 3px solid var(--wu-message-card-border);
  border-radius: 4px;
  padding: 2px 3px;
  flex-direction: column;
  line-height: 1.1;
  width: 100%;
  margin-bottom: 5px;
  break-inside: avoid;
  break-inside: avoid-column;
}

.MMM-Webuntis .messages-grid .messageRowEmpty {
  display: block; /* Override display: contents */
  padding: 2px 3px;
  color: var(--wu-muted-text);
  font-style: italic;
  width: 100%;
  margin-bottom: 5px;
  break-inside: avoid;
  break-inside: avoid-column;
}

.MMM-Webuntis .messages-grid .wu-col-full-width {
  width: 100%;
}
